from pwn import *
from Crypto.Util.number import *

context.log_level = "Error"

cipher = 4228273471152570993857755209040611143227336245190875847649142807501848960847851973658239485570030833999780269457000091948785164374915942471027917017922546

io = remote("titan.picoctf.net", 58366)

payload = b"E\n\x02"
io.sendline(payload)

io.recvuntil(b"ciphertext (m ^ e mod n) ")
num = int(io.recvline())

payload = b"D\n"
payload += str(num * cipher).encode()

io.sendline(payload)
io.recvuntil(b"(c ^ d mod n): ")
password = int(io.recvline().strip(), 16) // 2
password = long_to_bytes(password).decode()
print("Password = ", password)
