# Challenge Name: Tic-Tac

**Category:** Binary Exploitation / TOCTOU (Time-of-Check to Time-of-Use)

## üìù Description

In this challenge, we are given a program called `txtreader` that takes a filename as input and prints its contents ‚Äî but only if we are the owner of the file. The source code shows that it first checks if we own the file using `stat()` and then reads it using an `ifstream`.

The problem is that this check and use are done separately. That means there is a short time gap between the file being checked and being used. If we can change the file in that small time gap, we can trick the program. This is called a **Time-of-Check to Time-of-Use (TOCTOU)** vulnerability.

## üí° Exploitation Steps

1. Create a symlink called `flip` and keep switching it quickly between a file we own (`file`) and the secret file (`flag.txt`) using this command:

   ```bash
   while true; do ln -sf flag.txt flip; ln -sf file flip; done &
   ```

2. While the link is flipping rapidly, run the vulnerable program many times:

   ```bash
   for i in {1..200}; do ./txtreader flip; done
   ```

Because of the race condition, one of these times the program will:
- Check ownership when `flip` points to `file` (which we own),
- But open and read when `flip` points to `flag.txt`.

This bypasses the check and lets us read the flag.

## üèÅ Flag

```
picoCTF{--------------------}
```
